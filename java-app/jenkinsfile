pipeline {
  agent any

  stages {
    stage('Test') {
      steps {
        sh 'mvn test'
      }
    }
    stage('Build') {
      steps {
        sh 'mvn clean install'
      }
    }
  }

  post {
    failure {
      slackSend(channel: "#ibrahim", token: "slack-jenkins-secret-key token", color: "good", message: "${custom_msg()}")
    }
  }
}

def custom_msg() {
  def JENKINS_URL= ""
  def JOB_NAME = env.JOB_NAME
  def BUILD_ID= env.BUILD_ID
  def JENKINS_LOG= "FAILED: Job [${env.JOB_NAME}] Logs path: ${JENKINS_URL}/job/${JOB_NAME}/${BUILD_ID}/consoleText"
  return JENKINS_LOG
}


    
